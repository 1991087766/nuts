(function(t){function e(e){for(var a,o,i=e[0],c=e[1],l=e[2],d=0,m=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(n,o)&&n[o]&&m.push(n[o][0]),n[o]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(m.length)m.shift()();return s.push.apply(s,l||[]),r()}function r(){for(var t,e=0;e<s.length;e++){for(var r=s[e],a=!0,i=1;i<r.length;i++){var c=r[i];0!==n[c]&&(a=!1)}a&&(s.splice(e--,1),t=o(o.s=r[0]))}return t}var a={},n={app:0},s=[];function o(e){if(a[e])return a[e].exports;var r=a[e]={i:e,l:!1,exports:{}};return t[e].call(r.exports,r,r.exports,o),r.l=!0,r.exports}o.m=t,o.c=a,o.d=function(t,e,r){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(o.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)o.d(r,a,function(e){return t[e]}.bind(null,a));return r},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=e,i=i.slice();for(var l=0;l<i.length;l++)e(i[l]);var u=c;s.push([0,"chunk-vendors"]),r()})({0:function(t,e,r){t.exports=r("56d7")},"14c1":function(t,e,r){"use strict";r("64ef")},"21ba":function(t,e,r){},"2c0e":function(t,e,r){},4678:function(t,e,r){var a={"./af":"2bfb","./af.js":"2bfb","./ar":"8e73","./ar-dz":"a356","./ar-dz.js":"a356","./ar-kw":"423e","./ar-kw.js":"423e","./ar-ly":"1cfd","./ar-ly.js":"1cfd","./ar-ma":"0a84","./ar-ma.js":"0a84","./ar-sa":"8230","./ar-sa.js":"8230","./ar-tn":"6d83","./ar-tn.js":"6d83","./ar.js":"8e73","./az":"485c","./az.js":"485c","./be":"1fc1","./be.js":"1fc1","./bg":"84aa","./bg.js":"84aa","./bm":"a7fa","./bm.js":"a7fa","./bn":"9043","./bn-bd":"9686","./bn-bd.js":"9686","./bn.js":"9043","./bo":"d26a","./bo.js":"d26a","./br":"6887","./br.js":"6887","./bs":"2554","./bs.js":"2554","./ca":"d716","./ca.js":"d716","./cs":"3c0d","./cs.js":"3c0d","./cv":"03ec","./cv.js":"03ec","./cy":"9797","./cy.js":"9797","./da":"0f14","./da.js":"0f14","./de":"b469","./de-at":"b3eb","./de-at.js":"b3eb","./de-ch":"bb71","./de-ch.js":"bb71","./de.js":"b469","./dv":"598a","./dv.js":"598a","./el":"8d47","./el.js":"8d47","./en-au":"0e6b","./en-au.js":"0e6b","./en-ca":"3886","./en-ca.js":"3886","./en-gb":"39a6","./en-gb.js":"39a6","./en-ie":"e1d3","./en-ie.js":"e1d3","./en-il":"7333","./en-il.js":"7333","./en-in":"ec2e","./en-in.js":"ec2e","./en-nz":"6f50","./en-nz.js":"6f50","./en-sg":"b7e9","./en-sg.js":"b7e9","./eo":"65db","./eo.js":"65db","./es":"898b","./es-do":"0a3c","./es-do.js":"0a3c","./es-mx":"b5b7","./es-mx.js":"b5b7","./es-us":"55c9","./es-us.js":"55c9","./es.js":"898b","./et":"ec18","./et.js":"ec18","./eu":"0ff2","./eu.js":"0ff2","./fa":"8df4","./fa.js":"8df4","./fi":"81e9","./fi.js":"81e9","./fil":"d69a","./fil.js":"d69a","./fo":"0721","./fo.js":"0721","./fr":"9f26","./fr-ca":"d9f8","./fr-ca.js":"d9f8","./fr-ch":"0e49","./fr-ch.js":"0e49","./fr.js":"9f26","./fy":"7118","./fy.js":"7118","./ga":"5120","./ga.js":"5120","./gd":"f6b4","./gd.js":"f6b4","./gl":"8840","./gl.js":"8840","./gom-deva":"aaf2","./gom-deva.js":"aaf2","./gom-latn":"0caa","./gom-latn.js":"0caa","./gu":"e0c5","./gu.js":"e0c5","./he":"c7aa","./he.js":"c7aa","./hi":"dc4d","./hi.js":"dc4d","./hr":"4ba9","./hr.js":"4ba9","./hu":"5b14","./hu.js":"5b14","./hy-am":"d6b6","./hy-am.js":"d6b6","./id":"5038","./id.js":"5038","./is":"0558","./is.js":"0558","./it":"6e98","./it-ch":"6f12","./it-ch.js":"6f12","./it.js":"6e98","./ja":"079e","./ja.js":"079e","./jv":"b540","./jv.js":"b540","./ka":"201b","./ka.js":"201b","./kk":"6d79","./kk.js":"6d79","./km":"e81d","./km.js":"e81d","./kn":"3e92","./kn.js":"3e92","./ko":"22f8","./ko.js":"22f8","./ku":"2421","./ku.js":"2421","./ky":"9609","./ky.js":"9609","./lb":"440c","./lb.js":"440c","./lo":"b29d","./lo.js":"b29d","./lt":"26f9","./lt.js":"26f9","./lv":"b97c","./lv.js":"b97c","./me":"293c","./me.js":"293c","./mi":"688b","./mi.js":"688b","./mk":"6909","./mk.js":"6909","./ml":"02fb","./ml.js":"02fb","./mn":"958b","./mn.js":"958b","./mr":"39bd","./mr.js":"39bd","./ms":"ebe4","./ms-my":"6403","./ms-my.js":"6403","./ms.js":"ebe4","./mt":"1b45","./mt.js":"1b45","./my":"8689","./my.js":"8689","./nb":"6ce3","./nb.js":"6ce3","./ne":"3a39","./ne.js":"3a39","./nl":"facd","./nl-be":"db29","./nl-be.js":"db29","./nl.js":"facd","./nn":"b84c","./nn.js":"b84c","./oc-lnc":"167b","./oc-lnc.js":"167b","./pa-in":"f3ff","./pa-in.js":"f3ff","./pl":"8d57","./pl.js":"8d57","./pt":"f260","./pt-br":"d2d4","./pt-br.js":"d2d4","./pt.js":"f260","./ro":"972c","./ro.js":"972c","./ru":"957c","./ru.js":"957c","./sd":"6784","./sd.js":"6784","./se":"ffff","./se.js":"ffff","./si":"eda5","./si.js":"eda5","./sk":"7be6","./sk.js":"7be6","./sl":"8155","./sl.js":"8155","./sq":"c8f3","./sq.js":"c8f3","./sr":"cf1e","./sr-cyrl":"13e9","./sr-cyrl.js":"13e9","./sr.js":"cf1e","./ss":"52bd","./ss.js":"52bd","./sv":"5fbd","./sv.js":"5fbd","./sw":"74dc","./sw.js":"74dc","./ta":"3de5","./ta.js":"3de5","./te":"5cbb","./te.js":"5cbb","./tet":"576c","./tet.js":"576c","./tg":"3b1b","./tg.js":"3b1b","./th":"10e8","./th.js":"10e8","./tk":"5aff","./tk.js":"5aff","./tl-ph":"0f38","./tl-ph.js":"0f38","./tlh":"cf755","./tlh.js":"cf755","./tr":"0e81","./tr.js":"0e81","./tzl":"cf51","./tzl.js":"cf51","./tzm":"c109","./tzm-latn":"b53d","./tzm-latn.js":"b53d","./tzm.js":"c109","./ug-cn":"6117","./ug-cn.js":"6117","./uk":"ada2","./uk.js":"ada2","./ur":"5294","./ur.js":"5294","./uz":"2e8c","./uz-latn":"010e","./uz-latn.js":"010e","./uz.js":"2e8c","./vi":"2921","./vi.js":"2921","./x-pseudo":"fd7e","./x-pseudo.js":"fd7e","./yo":"7f33","./yo.js":"7f33","./zh-cn":"5c3a","./zh-cn.js":"5c3a","./zh-hk":"49ab","./zh-hk.js":"49ab","./zh-mo":"3a6c","./zh-mo.js":"3a6c","./zh-tw":"90ea","./zh-tw.js":"90ea"};function n(t){var e=s(t);return r(e)}function s(t){if(!r.o(a,t)){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e}return a[t]}n.keys=function(){return Object.keys(a)},n.resolve=s,t.exports=n,n.id="4678"},"4cae":function(t,e,r){},"4ddf":function(t,e,r){},"56d7":function(t,e,r){"use strict";r.r(e);r("e260"),r("e6cf"),r("cca6"),r("a79d"),r("e792"),r("0cdd");var a=r("2b0e"),n=r("5f5b"),s=r("b1e0");r("ab8b"),r("2dd8");a["default"].use(n["a"]),a["default"].use(s["a"]);r("4cae");var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{attrs:{id:"app"}},[r("side-bar",{attrs:{isToggled:t.isToggled},on:{toggleSideBar:t.handleToggleSideBar}}),r("div",{staticClass:"content-wrapper"},[r("top-bar",{staticClass:"mb-4",attrs:{isToggled:t.isToggled},on:{toggleSideBar:t.handleToggleSideBar}}),r("router-view")],1)],1)},i=[],c=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("nav",{staticClass:"navbar navbar-expand navbar-light bg-white topbar mb-4 static-top shadow"},[r("button",{staticClass:"btn btn-link d-md-none rounded-circle mr-3",attrs:{id:"sidebarToggleTop"},on:{click:t.toggleSideBar}},[r("b-icon",{attrs:{icon:"justify"}})],1),r("ul",{staticClass:"navbar-nav ml-auto"},[r("div",{staticClass:"topbar-divider"}),r("li",{staticClass:"nav-item dropdown no-arrow"},[r("b-dropdown",{staticClass:"nav-link",attrs:{variant:"link",right:"","toggle-class":"pr-0"},scopedSlots:t._u([{key:"button-content",fn:function(){return[r("b-avatar",{staticClass:"mt-2",attrs:{size:"large"}})]},proxy:!0}])},[r("b-dropdown-item",{attrs:{to:"/account"}},[r("b-icon",{staticClass:"mr-1",attrs:{icon:"person-bounding-box"}}),t._v(" 账户 ")],1),r("b-dropdown-divider"),r("b-dropdown-item",{attrs:{to:"/login"}},[r("b-icon",{staticClass:"mr-1",attrs:{icon:"box-arrow-right"}}),t._v(" 登出 ")],1)],1)],1)])])},l=[],u={props:["isToggled"],methods:{toggleSideBar:function(){this.$emit("toggleSideBar")}}},d=u,m=r("2877"),p=Object(m["a"])(d,c,l,!1,null,null,null),f=p.exports,b=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ul",{class:["navbar-nav","bg-gradient-primary","sidebar","sidebar-dark","accordion",t.isToggled?"toggled":""],attrs:{id:"accordionSidebar"}},[r("a",{staticClass:"sidebar-brand d-flex align-items-center justify-content-center",attrs:{href:"#"}},[r("div",{staticClass:"sidebar-brand-icon"},[r("b-icon",{attrs:{icon:"x-diamond"}})],1),r("div",{staticClass:"sidebar-brand-text mx-3"},[t._v("YUFU 量化")])]),r("hr",{staticClass:"sidebar-divider my-0"}),r("b-nav-item",{staticClass:"nav-link",attrs:{to:{name:"robot-list"}}},[r("b-icon",{staticClass:"mr-2",attrs:{icon:"cpu"}}),r("span",[t._v("机器人")])],1),r("b-nav-item",{staticClass:"nav-link",attrs:{to:{name:"strategy-list"}}},[r("b-icon",{staticClass:"mr-2",attrs:{icon:"graph-up"}}),r("span",[t._v("策略")])],1),r("b-nav-item",{staticClass:"nav-link",attrs:{to:{name:"credential"}}},[r("b-icon",{staticClass:"mr-2",attrs:{icon:"key"}}),r("span",[t._v("接入")])],1),r("div",{staticClass:"text-center d-none d-md-inline"},[r("b-button",{staticClass:"rounded-circle border-0 mt-3",attrs:{id:"sidebarToggle"},on:{click:t.sidebarToggle}},[r("b-icon",{staticClass:"toggle-icon",attrs:{icon:t.isToggled?"chevron-right":"chevron-left"}})],1)],1)],1)},v=[],g={props:["isToggled"],methods:{sidebarToggle:function(){this.$emit("toggleSideBar")}}},h=g,_=(r("a736"),Object(m["a"])(h,b,v,!1,null,null,null)),y=_.exports,x={name:"App",data:function(){return{isToggled:!0}},mounted:function(){var t=this;window.onresize=function(){var e=document.documentElement.clientWidth;t.isToggled=!(e>576)}},components:{TopBar:f,SideBar:y},methods:{handleToggleSideBar:function(){this.isToggled=!this.isToggled}}},w=x,k=(r("5c0b"),Object(m["a"])(w,o,i,!1,null,null,null)),j=k.exports,C=r("23cf"),T=r.n(C),O=r("f206"),E=r.n(O),$=r("8c4f"),R=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-container",{attrs:{fluid:""}},[r("robot-form",{attrs:{"credential-options":t.credentialOptions,"strategy-options":t.strategyOptions}})],1)},S=[],I=r("1da1"),D=(r("96cf"),r("d81d"),r("99af"),r("b0c0"),function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-form",{on:{submit:t.onSubmit}},[r("b-row",[r("b-col",{attrs:{sm:"12",md:"8"}},[r("b-card",{attrs:{header:"基本设置","header-tag":"header"}},[r("b-row",[r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"名字:","label-for":"id_name"}},[r("b-form-input",{attrs:{id:"id_name",type:"text",state:void 0===t.formErrors.name&&null},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.name&&null}},[t._v(" "+t._s(void 0!==t.formErrors.name&&t.formErrors.name[0])+" ")])],1)],1),r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"交易所凭证:","label-for":"id_credential"}},[r("b-form-select",{attrs:{id:"id_credential",options:t.credentialOptions,required:"",state:void 0===t.formErrors.credential&&null},model:{value:t.form.credential,callback:function(e){t.$set(t.form,"credential",e)},expression:"form.credential"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.credential&&null}},[t._v(" "+t._s(void 0!==t.formErrors.credential&&t.formErrors.credential[0])+" ")])],1)],1)],1)],1),r("b-card",{staticClass:"mt-3",attrs:{header:"市场","header-tag":"header"}},[r("b-row",[r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"市场类型:","label-for":"id_market_type"}},[r("b-form-select",{attrs:{id:"idMarketType",options:t.marketTypeOptions,required:"",state:void 0===t.formErrors["market_type"]&&null},model:{value:t.form.marketType,callback:function(e){t.$set(t.form,"marketType",e)},expression:"form.marketType"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors["market_type"]&&null}},[t._v(" "+t._s(void 0!==t.formErrors["market_type"]&&t.formErrors["market_type"][0])+" ")])],1)],1),r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"交易对:","label-for":"id_pair"}},[r("b-form-input",{attrs:{type:"text",id:"id_pair",state:void 0===t.formErrors.pair&&null},model:{value:t.form.pair,callback:function(e){t.$set(t.form,"pair",e)},expression:"form.pair"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.pair&&null}},[t._v(" "+t._s(void 0!==t.formErrors.pair&&t.formErrors.pair[0])+" ")])],1)],1),"spots"===t.form.marketType?[r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"基础币种:","label-for":"id_base_currency",description:"通常为交易对中作为资产被交易的币种。例如 BTCUSDT，基础币种为 BTC。"}},[r("b-form-input",{attrs:{type:"text",id:"id_base_currency",state:void 0===t.formErrors["base_currency"]&&null},model:{value:t.form.baseCurrency,callback:function(e){t.$set(t.form,"baseCurrency",e)},expression:"form.baseCurrency"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors["base_currency"]&&null}},[t._v(" "+t._s(void 0!==t.formErrors["base_currency"]&&t.formErrors["base_currency"][0])+" ")])],1)],1),r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"计价币种:","label-for":"id_quote_currency",description:"通常为交易对中对被交易资产计价的币种。例如 BTCUSDT，计价币种为 USDT。"}},[r("b-form-input",{attrs:{type:"text",id:"id_quote_currency",state:void 0===t.formErrors["quote_currency"]&&null},model:{value:t.form.quoteCurrency,callback:function(e){t.$set(t.form,"quoteCurrency",e)},expression:"form.quoteCurrency"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors["quote_currency"]&&null}},[t._v(" "+t._s(void 0!==t.formErrors["quote_currency"]&&t.formErrors["quote_currency"][0])+" ")])],1)],1)]:t._e()],2)],1),r("b-card",{staticClass:"mt-3",attrs:{header:"策略","header-tag":"header"}},[r("b-row",[r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"策略:","label-for":"id_strategy_template"}},[r("b-form-select",{attrs:{options:t.strategyOptions,id:"id_strategy_template",required:"",state:void 0===t.formErrors.strategy&&null},model:{value:t.form.strategy,callback:function(e){t.$set(t.form,"strategy",e)},expression:"form.strategy"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.strategy&&null}},[t._v(" "+t._s(void 0!==t.formErrors.strategy&&t.formErrors.strategy[0])+" ")])],1)],1),r("b-col",{attrs:{sm:"12",md:"6"}},[r("b-form-group",{attrs:{label:"目标币种:","label-for":"id_target_currency",description:"合约交易为保证金币种；现货交易为想赚取的币种。"}},[r("b-form-input",{attrs:{type:"text",id:"id_target_currency",state:void 0===t.formErrors["target_currency"]&&null},model:{value:t.form.targetCurrency,callback:function(e){t.$set(t.form,"targetCurrency",e)},expression:"form.targetCurrency"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors["target_currency"]&&null}},[t._v(" "+t._s(void 0!==t.formErrors["target_currency"]&&t.formErrors["target_currency"][0])+" ")])],1)],1)],1)],1)],1),r("b-col",{attrs:{sm:"12",md:"4"}},[r("div",[r("b-card",{attrs:{title:"帮助文档"}},[r("b-card-text",[r("a",{attrs:{href:"https://yufuquant.github.io/yufuquant-user-manual/robot/#%E5%88%9B%E5%BB%BA%E6%9C%BA%E5%99%A8%E4%BA%BA",target:"_blank"}},[t._v("渔夫量化用户手册：创建机器人")])])],1)],1),r("b-button",{staticClass:"mt-3",attrs:{block:"",type:"submit",variant:"primary",disabled:t.submitting}},[t._v("创建")])],1)],1)],1)}),P=[],L=(r("d3b7"),r("bc3a")),H=r.n(L),z={storageKeyPrefix:"yufuquant:",loadUser:function(){var t=JSON.parse(localStorage.getItem(this.storageKeyPrefix+"user")||"null");return t||{userId:-1,username:"",nickname:""}},saveUser:function(t){localStorage.setItem(this.storageKeyPrefix+"user",JSON.stringify(t))},loadAuthToken:function(){return localStorage.getItem(this.storageKeyPrefix+"auth-token")||""},saveAuthToken:function(t){localStorage.setItem(this.storageKeyPrefix+"auth-token",t)},clear:function(){localStorage.removeItem(this.storageKeyPrefix+"user"),localStorage.removeItem(this.storageKeyPrefix+"auth-token")}},U=z,q=r("2f62"),N=r("5530"),B={SET_USER:function(t,e){t.user=Object(N["a"])({},e)},REMOVE_USER:function(t){t.user={userId:-1,username:"",nickname:""}},SET_AUTH_TOKEN:function(t,e){t.authToken=e},REMOVE_AUTH_TOKEN:function(t){t.authToken=""}},A={isAuthenticated:function(t){return""!==t.authToken}};a["default"].use(q["a"]);var F=new q["a"].Store({state:{authToken:U.loadAuthToken(),user:U.loadUser()},mutations:B,getters:A}),V=F,K=H.a.create({baseURL:window.conf.restApiBaseUrl,timeout:1e4});K.interceptors.request.use((function(t){return t.headers["Content-Type"]="application/json",t.headers["Accept"]="application/json",t}));var M=H.a.create({baseURL:window.conf.restApiBaseUrl,timeout:1e4});function J(t,e){return W.apply(this,arguments)}function W(){return W=Object(I["a"])(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.patch("/robots/".concat(e,"/strategyParameters/"),r));case 1:case"end":return t.stop()}}),t)}))),W.apply(this,arguments)}function Y(t){return Z.apply(this,arguments)}function Z(){return Z=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.post("/robots/",e));case 1:case"end":return t.stop()}}),t)}))),Z.apply(this,arguments)}function G(t){return Q.apply(this,arguments)}function Q(){return Q=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.get("/robots/".concat(e,"/strategySpecView/")));case 1:case"end":return t.stop()}}),t)}))),Q.apply(this,arguments)}M.interceptors.request.use((function(t){return t.headers["Content-Type"]="application/json",t.headers["Accept"]="application/json",V.state.authToken&&(t.headers["Authorization"]="Token "+V.state.authToken),t})),M.interceptors.response.use((function(t){return t}),(function(t){return 401===t.response.status&&(U.clear(),"/login"!==window.location.pathname)?(window.location.href="/#/login",null):Promise.reject(t)}));var X={name:"RobotForm",props:{credentialOptions:{type:Array},strategyOptions:{type:Array}},data:function(){return{form:{name:"",credential:null,pair:"",marketType:null,baseCurrency:"",quoteCurrency:"",targetCurrency:"",strategy:null},marketTypeOptions:[{value:null,text:"选择市场类型"},{value:"spots",text:"现货"},{value:"margin",text:"杠杆"},{value:"linear_delivery",text:"线性交割合约"},{value:"linear_perpetual",text:"线性永续合约"},{value:"inverse_delivery",text:"反向交割合约"},{value:"inverse_perpetual",text:"反向永续合约"}],submitting:!1,formErrors:{}}},methods:{onSubmit:function(t){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.preventDefault(),e.submitting=!0,a={name:e.form.name,credential:e.form.credential,market_type:e.form.marketType,pair:e.form.pair,base_currency:e.form.baseCurrency,quote_currency:e.form.quoteCurrency,strategy:e.form.strategy,target_currency:e.form.targetCurrency},r.prev=3,r.next=6,Y(a);case 6:return e.submitting=!1,r.next=9,e.$router.push({name:"robot-list"});case 9:r.next=15;break;case 11:r.prev=11,r.t0=r["catch"](3),r.t0.response?500===r.t0.response.status?e.$bvToast.toast("服务端错误",{title:"机器人创建失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):400===r.t0.response.status&&(e.formErrors=r.t0.response.data):e.$bvToast.toast(r.t0.message,{title:"机器人创建失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}),e.submitting=!1;case 15:case"end":return r.stop()}}),r,null,[[3,11]])})))()}}},tt=X,et=Object(m["a"])(tt,D,P,!1,null,null,null),rt=et.exports;function at(){return nt.apply(this,arguments)}function nt(){return nt=Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",K.get("/exchanges/"));case 1:case"end":return t.stop()}}),t)}))),nt.apply(this,arguments)}function st(){return ot.apply(this,arguments)}function ot(){return ot=Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,M.get("/credentials/?include=exchange");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),ot.apply(this,arguments)}function it(t,e){return ct.apply(this,arguments)}function ct(){return ct=Object(I["a"])(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.patch("/robots/"+e+"/",r));case 1:case"end":return t.stop()}}),t)}))),ct.apply(this,arguments)}function lt(t){return ut.apply(this,arguments)}function ut(){return ut=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.delete("/robots/"+e+"/"));case 1:case"end":return t.stop()}}),t)}))),ut.apply(this,arguments)}function dt(t){return mt.apply(this,arguments)}function mt(){return mt=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.get("/robots/"+e+"/"));case 1:case"end":return t.stop()}}),t)}))),mt.apply(this,arguments)}function pt(){return ft.apply(this,arguments)}function ft(){return ft=Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.get("/robots/"));case 1:case"end":return t.stop()}}),t)}))),ft.apply(this,arguments)}function bt(){return vt.apply(this,arguments)}function vt(){return vt=Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.get("/strategies/"));case 1:case"end":return t.stop()}}),t)}))),vt.apply(this,arguments)}var gt={data:function(){return{credentialOptions:[],strategyOptions:[]}},components:{RobotForm:rt},methods:{getCredentialOptions:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,st();case 3:r=e.sent,t.credentialOptions=r.data.map((function(t){return{value:t.id,text:"".concat(t.exchange.name," - ").concat(t.note)}})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("无法获取交易所凭据",{title:"无法获取交易所凭据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"无法获取交易所凭据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getStrategyOptions:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bt();case 3:r=e.sent,t.strategyOptions=r.data.results.map((function(t){return{value:t.id,text:t.name}})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("无法获取策略列表数据",{title:"无法获取策略列表数据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"无法获取策略列表数据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},mounted:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCredentialOptions();case 2:return e.next=4,t.getStrategyOptions();case 4:case"end":return e.stop()}}),e)})))()}},ht=gt,_t=Object(m["a"])(ht,R,S,!1,null,"310a4b4c",null),yt=_t.exports,xt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"robot-list-view"},[r("div",{staticClass:"ml-3 mb-3"},[r("router-link",{attrs:{to:{name:"robot-create"}}},[r("b-button",{attrs:{variant:"primary"}},[r("b-icon",{attrs:{icon:"plus","aria-hidden":"true"}}),t._v(" 创建机器人 ")],1)],1)],1),r("b-row",t._l(t.robotList,(function(e){return r("b-col",{key:e.robotId,attrs:{lg:"4",md:"6",sm:"12"}},[r("robot-list-item",{attrs:{robot:e},on:{refresh:t.refreshList}})],1)})),1)],1)},wt=[],kt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",{staticClass:"mb-4 card"},[r("div",{staticClass:"d-flex align-items-center"},[r("span",{class:["mr-1","d-inline-flex",t.robotStatusClass]},[r("b-icon",{attrs:{icon:"circle-fill","font-scale":"0.6",animation:t.robotStatusAnimation}})],1),r("router-link",{staticClass:"font-weight-bold text-body",attrs:{to:{name:"robot",params:{id:t.robot.robotId}}}},[r("span",{staticClass:"mr-2"},[t._v(t._s(t.robot.name))]),r("span",{staticClass:"text-muted font-weight-light"},[t._v(t._s(t.robot.exchangeNameZh)+" "+t._s(t.robot.pair))])]),r("span",{staticClass:"ml-auto action-buttons"},[r("router-link",{staticClass:"mr-2",attrs:{to:{name:"robot-update",params:{id:t.robot.robotId}}}},[r("b-icon-pencil-square")],1),r("a",{staticClass:"text-danger",attrs:{href:"#"},on:{click:t.showMsgBox}},[r("b-icon-trash")],1)],1)],1),r("div",{staticClass:"d-flex justify-content-between mt-2"},[r("span",[r("span",{staticClass:"small text-muted"},[t._v("收益率")]),r("br"),r("span",{class:[t.profitColorClass,"h6"]},[t._v(t._s(t.robot.profitRatioPtg))])]),r("span",[r("span",{staticClass:"small text-muted"},[t._v("收益额("+t._s(t.robot.targetCurrency)+")")]),r("br"),r("span",{class:t.profitColorClass},[r("small",[t._v(t._s(t._f("roundByCurrency")(t.robot.profit,t.robot.targetCurrency)))])])]),r("span",[r("span",{staticClass:"small text-muted"},[t._v("本金("+t._s(t.robot.targetCurrency)+")")]),r("br"),r("span",{},[r("small",[t._v(" "+t._s(t._f("roundByCurrency")(t.robot.principal,t.robot.targetCurrency)))])])]),r("span",[r("span",{staticClass:"small text-muted"},[t._v("余额("+t._s(t.robot.targetCurrency)+")")]),r("br"),r("span",{},[r("small",[t._v(t._s(t._f("roundByCurrency")(t.robot.balance,t.robot.targetCurrency)))])])])]),r("hr"),r("div",{staticClass:"small d-flex justify-content-between"},[r("div",{staticClass:"d-inline-block"},[r("span",{staticClass:"mr-1 text-muted"},[t._v("较前日")]),r("span",{class:[t.profit24hColorClass,"mr-1"]},[t.robot.profit24h>0?r("b-icon-caret-up-fill"):t._e(),t.robot.profit24h<0?r("b-icon-caret-down-fill"):t._e(),t._v(" "+t._s(t.robot.profitRatioPtg24h)+" ")],1),r("span",{class:t.profit24hColorClass},[t._v(" "+t._s(t._f("roundByCurrency")(t.robot.profit24h,t.robot.targetCurrency))+" "),r("span",{staticClass:"font-weight-light"},[t._v(" "+t._s(t.robot.targetCurrency))])])]),r("div",{staticClass:"d-inline-block"},[r("b-icon",{staticClass:"mr-1",attrs:{icon:"graph-up"}}),r("span",{},[t._v(" "+t._s(t.robot.strategyName)+" ")]),r("span",{staticClass:"text-muted"},[t._v(" "+t._s(t.robot.durationDisplay)+" ")])],1)])])},jt=[],Ct=(r("b680"),r("c1df")),Tt=r.n(Ct),Ot={name:"RobotListItem",props:{robot:Object},computed:{robotStatusClass:function(){return Tt()().diff(this.robot.pingTime,"seconds")<60?"text-success":"text-danger"},robotStatusAnimation:function(){return"text-danger"===this.robotStatusClass?"":"throb"},profitColorClass:function(){return this.robot.profit>0?"text-success":this.robot.profit<0?"text-danger":""},profit24hColorClass:function(){return this.robot.profit24h>0?"text-success":this.robot.profit24h<0?"text-danger":""}},filters:{roundByCurrency:function(t,e){switch(e){case"BTC":return t.toFixed(4);case"USDT":return t.toFixed(2);default:return t}}},methods:{showMsgBox:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.$bvModal.msgBoxConfirm("删除机器人将同时删除其所有资产统计数据。",{title:"确认删除？",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"确认",cancelTitle:"取消",footerClass:"p-2",hideHeaderClose:!1,centered:!0});case 2:if(r=e.sent,r){e.next=5;break}return e.abrupt("return");case 5:return e.prev=5,e.next=8,lt(t.robot.robotId);case 8:t.$emit("refresh"),e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](5),t.$bvToast.toast("无法删除机器人数据，错误信息：".concat(e.t0.data||"未知错误"),{title:"删除失败",autoHideDelay:3e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 14:case"end":return e.stop()}}),e,null,[[5,11]])})))()}}},Et=Ot,$t=(r("9f80"),Object(m["a"])(Et,kt,jt,!1,null,"26a7a6da",null)),Rt=$t.exports,St={name:"robot-list",components:{RobotListItem:Rt},data:function(){return{robotList:[],timer:""}},methods:{refreshList:function(){this.getRobotList()},setRobotList:function(t){this.robotList=t.map((function(t){return{robotId:t.id,name:t.name,pair:t.pair,targetCurrency:t.target_currency,enabled:t.enabled,startTime:t["start_time"],pingTime:t["ping_time"],createdAt:t["created_at"],durationDisplay:t["duration_display"],strategyName:t["strategy_name"],exchangeNameZh:t["exchange"]["name_zh"],exchangeName:t.exchange.name,profitRatioPtg:t["asset_record"]["total_pnl_rel_ptg"],profitRatioPtg24h:t["asset_record"]["total_pnl_rel_ptg_24h"],profit24h:t["asset_record"]["total_pnl_abs_24h"],profit:t["asset_record"]["total_pnl_abs"],principal:t["asset_record"]["total_principal"],balance:t["asset_record"]["total_balance"]}}))},getRobotList:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,pt();case 3:r=e.sent,t.setRobotList(r.data),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("无法获取机器人列表数据",{title:"无法获取机器人列表数据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"无法获取机器人列表数据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},handleVisibilityChange:function(){var t=document.hidden;t?clearInterval(this.timer):(this.timer&&clearInterval(this.timer),this.timer=setInterval(this.getRobotList,1e4))}},mounted:function(){this.getRobotList(),this.timer=setInterval(this.getRobotList,1e4),window.addEventListener("visibilitychange",this.handleVisibilityChange,!1)},beforeDestroy:function(){clearInterval(this.timer)}},It=St,Dt=(r("14c1"),Object(m["a"])(It,xt,wt,!1,null,"163dc308",null)),Pt=Dt.exports,Lt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-row",[r("b-col",{attrs:{md:"6"}},[r("robot-update-form")],1)],1)},Ht=[],zt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",{staticClass:"mt-2"},[r("b-form",{on:{submit:t.onSubmit}},[r("b-form-row",[r("b-col",{attrs:{md:"12"}},[r("label",[t._v("名字")])]),r("b-col",{attrs:{md:"12"}},[r("b-form-input",{attrs:{type:"text"},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1)],1),r("b-form-row",{staticClass:"mt-2"},[r("b-col",{attrs:{md:"12"}},[r("label",[t._v("启用")])]),r("b-col",{attrs:{md:"12"}},[r("b-form-checkbox",{attrs:{id:"id_enable",name:"enable",value:"true","unchecked-value":"false"},model:{value:t.form.enable,callback:function(e){t.$set(t.form,"enable",e)},expression:"form.enable"}})],1)],1),r("b-button",{staticClass:"mt-3",attrs:{block:"",type:"submit",variant:"primary"}},[t._v("更新")])],1)],1)},Ut=[],qt=r("5b01"),Nt={data:function(){return{formatter:new qt["Formatter"]}}},Bt=Nt,At={name:"RobotUpdateForm",mixins:[Bt],data:function(){return{form:{name:"",enable:!1,strategyTemplate:null},strategyTemplateOptions:[]}},computed:{robotId:function(){return this.$route.params.id}},methods:{onSubmit:function(t){var e=this;t.preventDefault();var r={name:this.form.name,enable:this.form.enable};it(this.robotId,this.formatter.serialize(Object(N["a"])({type:"robots",id:this.robotId},r))).then((function(){e.$router.push("/robot/".concat(e.robotId))})).catch((function(t){console.log(t.data)}))},initRobotForm:function(t){this.form={name:t.name,enabled:t.enabled}},getRobotsId:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt(t.robotId);case 3:r=e.sent,t.initRobotForm(t.formatter.deserialize(r.data)),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),t.$bvToast.toast("无法更新机器人数据，错误信息：".concat(e.t0.data||"未知错误"),{title:"数据更新失败",autoHideDelay:3e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},mounted:function(){this.getRobotsId()}},Ft=At,Vt=Object(m["a"])(Ft,zt,Ut,!1,null,null,null),Kt=Vt.exports,Mt={data:function(){return{}},components:{RobotUpdateForm:Kt}},Jt=Mt,Wt=Object(m["a"])(Jt,Lt,Ht,!1,null,"16f3f066",null),Yt=Wt.exports,Zt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-row",{staticClass:"m-1"},[r("b-col",{attrs:{md:"8"}},[r("log-panel",{attrs:{logList:t.logList}}),r("b-card",{staticClass:"mt-3",attrs:{"no-body":""}},[r("b-tabs",{attrs:{card:""}},[r("b-tab",{attrs:{title:"持有仓位",active:""}},[r("position",{attrs:{"position-store":t.positionStore}})],1),r("b-tab",{attrs:{title:"当前委托"}},[r("order",{attrs:{"order-store":t.orderStore}})],1)],1)],1)],1),r("b-col",{attrs:{md:"4"}},[r("overview",{attrs:{"overview-data":t.overviewData}}),r("b-card",{staticClass:"mt-3",attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[r("div",{staticClass:"d-flex justify-content-between align-items-center"},[r("span",{staticClass:"h6"},[t._v("参数预览")]),r("a",{directives:[{name:"b-modal",rawName:"v-b-modal.param-form-modal",modifiers:{"param-form-modal":!0}}],attrs:{href:"#"}},[r("b-icon-pencil-square")],1)])]},proxy:!0}])},[r("param-preview",{attrs:{parameters:t.strategySpecView&&t.strategySpecView.parameters}})],1)],1),r("b-modal",{attrs:{"button-size":"sm",size:"md",id:"param-form-modal",scrollable:"",centered:"",title:"参数设置"},scopedSlots:t._u([{key:"modal-footer",fn:function(e){var a=e.ok;return[r("b-button",{attrs:{size:"sm",variant:"primary"},on:{click:function(e){return t.onSubmit(a,e)}}},[t._v("确认")])]}}])},[r("param-form",{ref:"paramForm",attrs:{fields:t.strategySpecView&&t.strategySpecView.parameters}})],1)],1)},Gt=[],Qt=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",{attrs:{"no-body":"","header-tag":"header","bg-variant":"dark","text-variant":"white"},scopedSlots:t._u([{key:"header",fn:function(){return[r("div",[r("span",[t._v("日志监控")])])]},proxy:!0}])},[r("ul",{ref:"robotLogUl",staticClass:"list-unstyled robot-log-ul px-3 pt-2 pb-5 small mb-0 log-content"},[t._l(t.logList,(function(e,a){return r("li",{key:a},[e.timestamp?r("span",[t._v(t._s(t._f("timeFormatter")(e.timestamp)))]):t._e(),e.level?r("span",{class:["mx-1",t.levelColor(e.level)]},[t._v(t._s(e.level.toUpperCase()))]):t._e(),t._v(" "+t._s(e.text)+" ")])})),t.logList.length?t._e():r("li",[t._v("正在等待接收日志......")])],2)])},Xt=[],te={name:"LogPanel",props:["logList"],data:function(){return{robotId:null,ws:null}},watch:{logList:function(){this.updateScroll()}},filters:{timeFormatter:function(t){return Tt()(t).format("YYYY-MM-DD HH:mm:ss")}},mounted:function(){this.robotId=this.$route.params.id},methods:{updateScroll:function(){var t=this;this.$nextTick((function(){t.$refs.robotLogUl.scrollTop=t.$refs.robotLogUl.scrollHeight-t.$refs.robotLogUl.clientHeight}))},levelColor:function(t){switch(t.toUpperCase()){case"DEBUG":return"text-secondary";case"INFO":return"text-info";case"WARNING":return"text-warning";case"ERROR":return"text-danger";case"SUCCESS":return"text-success";default:return""}}}},ee=te,re=(r("a050"),Object(m["a"])(ee,Qt,Xt,!1,null,null,null)),ae=re.exports,ne=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.parameters?r("div",t._l(t.parameters,(function(e){return r("div",{key:e.code,staticClass:"d-flex align-items-center mb-2"},[r("div",{staticClass:"label"},[r("span",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover",modifiers:{hover:!0}}],class:["mr-2",t.underLineClass(e)],attrs:{title:e.description}},[t._v(t._s(e.name))])]),r("span",[t._v(t._s(t.formatValue(e)||"-"))])])})),0):t._e()},se=[],oe=(r("a4d3"),r("e01a"),r("7db0"),{name:"ParamPreview",props:["parameters"],methods:{underLineClass:function(t){return t.description?"underline":""},formatValue:function(t){if("enum"===t.type){var e=t.items.find((function(e){return e.value===t.value}));return e?e.display:""}return t.value}}}),ie=oe,ce=(r("de3f"),Object(m["a"])(ie,ne,se,!1,null,"080bfd5b",null)),le=ce.exports,ue=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-form",t._l(t.fields,(function(e){return r("b-form-group",{key:e.code,attrs:{label:e.name,description:e.description}},["number"===t.getInputType(e)?r(t.fieldFactory(e.type),{tag:"component",attrs:{items:e.items,type:"number"},model:{value:t.form[e.code],callback:function(r){t.$set(t.form,e.code,t._n(r))},expression:"form[field.code]"}}):r(t.fieldFactory(e.type),{tag:"component",attrs:{items:e.items},model:{value:t.form[e.code],callback:function(r){t.$set(t.form,e.code,r)},expression:"form[field.code]"}})],1)})),1)},de=[],me=(r("159b"),r("4797")),pe=r("c3e6"),fe=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-form-select",{attrs:{value:t.value},on:{input:function(e){return t.$emit("select",e)}}},t._l(t.options,(function(e){return r("b-form-select-option",{key:e.value,attrs:{value:e.value,selected:e.value===t.value}},[t._v(t._s(e.text)+" ")])})),1)},be=[],ve={props:["items","value"],computed:{options:function(){return this.items.map((function(t){return{value:t.value,text:t.display}}))}},model:{prop:"value",event:"select"}},ge=ve,he=Object(m["a"])(ge,fe,be,!1,null,null,null),_e=he.exports,ye={name:"parameter-form",props:{fields:Array},mounted:function(){this.initForm()},data:function(){return{form:{},strategyTemplateOptions:[]}},components:{BFormInput:me["a"]},methods:{getInputType:function(t){return"float"===t.type||"integer"===t.type?"number":"text"},initForm:function(){var t=this;this.fields.forEach((function(e){t.$set(t.form,e.code,e.value)}))},fieldFactory:function(t){switch(t){case"boolean":return pe["a"];case"integer":case"float":return me["a"];case"enum":return _e;default:return me["a"]}}}},xe=ye,we=(r("847e"),Object(m["a"])(xe,ue,de,!1,null,"b4e95488",null)),ke=we.exports,je=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.positionStore?r("div",t._l(t.positionStore.positions,(function(t,e){return r("div",{key:e},[r("position-item",{attrs:{position:t}})],1)})),0):t._e()},Ce=[],Te=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"justify-content-between d-flex"},[r("div",[r("div",{staticClass:"small text-secondary"},[t._v("持仓数量")]),r("div",{class:t.getProfitColorClass(t.position)},[t._v(t._s(t.position.qty*t.position.side))])]),r("div",[r("div",{staticClass:"small text-secondary"},[t._v("均价")]),r("div",[t._v(t._s(t.position.avgPrice))])]),r("div",[r("div",{staticClass:"small text-secondary"},[t._v("强平价")]),r("div",[t._v(t._s(t.position.liqPrice))])]),r("div",[r("div",{staticClass:"small text-secondary"},[t._v("未实现盈亏")]),r("div",{class:t.getUplColor(t.position)},[t._v(t._s(t.position.unrealizedPnl))])])])},Oe=[],Ee={name:"PositionItem",props:{position:Object},methods:{getProfitColorClass:function(t){return t.side>0?"text-success":"text-danger"},getUplColor:function(t){return t.unrealizedPnl>0?"text-success":"text-danger"}}},$e=Ee,Re=Object(m["a"])($e,Te,Oe,!1,null,"694657c5",null),Se=Re.exports,Ie={name:"Position",props:{positionStore:Object},components:{PositionItem:Se},mounted:function(){console.log(this.positionStore)}},De=Ie,Pe=Object(m["a"])(De,je,Ce,!1,null,null,null),Le=Pe.exports,He=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",{attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[r("div",{staticClass:"d-flex justify-content-between align-items-center"},[r("span",{staticClass:"h6 m-0"},[t._v("机器人")])])]},proxy:!0}])},[t.overviewData?r("div",[r("div",{staticClass:"mb-1"},[t._v("ID："+t._s(t.overviewData.RobotId))]),r("div",{staticClass:"mb-1"},[t._v("名称："+t._s(t.overviewData.name))]),r("div",{staticClass:"mb-1"},[t._v("市场类型："+t._s(t.overviewData.marketTypeDisplay))]),r("div",{staticClass:"mb-1"},[t._v("交易对："+t._s(t.overviewData.pair))]),r("div",{staticClass:"mb-1"},[t._v("基础币种："+t._s(t.overviewData.baseCurrency))]),r("div",{staticClass:"mb-1"},[t._v("计价币种："+t._s(t.overviewData.quoteCurrency))]),r("div",{staticClass:"mb-1"},[t._v("策略："+t._s(t.overviewData.strategyName))]),r("div",{staticClass:"mb-1"},[t._v("目标币种："+t._s(t.overviewData.targetCurrency))]),r("div",{staticClass:"mb-1"},[t._v("运行时间："+t._s(t.overviewData.durationDisplay))]),r("div",{staticClass:"mb-1"},[t._v("本金："+t._s(t.overviewData.totalPrincipal))]),r("div",{staticClass:"mb-1"},[t._v("余额："+t._s(t.overviewData.totalBalance))]),r("div",{staticClass:"mb-1"},[t._v("收益额："+t._s(t.overviewData.totalPnlAbs))]),r("div",{staticClass:"mb-1"},[t._v("收益率："+t._s(t.overviewData.totalPnlRelPtg))]),r("div",{staticClass:"mb-1"},[t._v("较前日：10(10.2%)")])]):t._e()])},ze=[],Ue={props:{overviewData:Object},data:function(){return{}},methods:{}},qe=Ue,Ne=Object(m["a"])(qe,He,ze,!1,null,null,null),Be=Ne.exports,Ae=function(){var t=this,e=t.$createElement,r=t._self._c||e;return t.orderStore?r("div",t._l(t.orderStore.orders,(function(t,e){return r("div",{key:e},[r("order-item",{attrs:{order:t}})],1)})),0):t._e()},Fe=[],Ve=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"justify-content-between d-flex"},[t._m(0),t._m(1),r("div",[r("div",{staticClass:"small text-secondary"},[t._v("价格")]),r("div",[t._v(t._s(t.order.price))])]),r("div",[r("div",{staticClass:"small text-secondary"},[t._v("数量")]),r("div",{class:t.getProfitColorClass(t.order)},[t._v(t._s(t.order.qty))])])])},Ke=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"small text-secondary"},[t._v("类型")]),r("div",[t._v("限价委托")])])},function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",{staticClass:"small text-secondary"},[t._v("方向")]),r("div",[t._v("卖")])])}],Me={name:"PositionItem",props:{order:Object},methods:{getProfitColorClass:function(t){return t.side>0?"text-success":"text-danger"}}},Je=Me,We=Object(m["a"])(Je,Ve,Ke,!1,null,"4ccc6a52",null),Ye=We.exports,Ze={name:"Order",props:["orderStore"],components:{OrderItem:Ye}},Ge=Ze,Qe=Object(m["a"])(Ge,Ae,Fe,!1,null,null,null),Xe=Qe.exports,tr={name:"RobotView",data:function(){return{logList:[],robotId:null,strategySpecView:null,overviewData:null,positionStore:null,orderStore:null}},computed:Object(N["a"])({},Object(q["b"])(["authToken"])),components:{LogPanel:ae,ParamPreview:le,ParamForm:ke,Overview:Be,Position:Le,Order:Xe},mounted:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getRobot();case 2:return e.next=4,t.getStrategySpecView();case 4:t.initWebsocket();case 5:case"end":return e.stop()}}),e)})))()},beforeDestroy:function(){if(this.ws){this._send({cmd:"unsub",topics:["robot#".concat(this.robotId,".log"),"robot#".concat(this.robotId,".store")]});var t=this.ws;this.ws=null,t.close()}},methods:{initWebsocket:function(){var t=this,e="".concat(window.conf.websocketApiUri);this.ws=new WebSocket(e),this.ws.onmessage=function(e){e=JSON.parse(e.data),e.ping?t._send({pong:e.ping}):e.code?200===e.code?(t._send({cmd:"sub",topics:["robot#".concat(t.robotId,".log"),"robot#".concat(t.robotId,".store")]}),t.logList.push({timestamp:Date.now(),level:"success",text:"认证成功, 订阅中..."})):400===e.code&&t.logList.push({timestamp:Date.now(),level:"error",text:"认证失败"}):"robotLog"===e.category?t.logList.push(e.data):"robotPositionStore"===e.category?t.positionStore=e.data:"robotOrderStore"===e.category?t.orderStore=e.data:console.log(e)},this.ws.onopen=function(){t.logList.push({timestamp:Date.now(),level:"INFO",text:"已建立 websocket 连接, token 认证中..."}),t._send({cmd:"auth",auth_token:t.authToken})},this.ws.onerror=function(t){console.log("error event:",t)},this.ws.onclose=function(){t.logList.push({timestamp:Date.now(),level:"ERROR",text:"Websocket 连接已断开！"}),t.ws&&t.reconnect()}},reconnect:function(){var t=this;setTimeout((function(){t.logList.push({timestamp:Date.now(),level:"INFO",text:"正在尝试重新建立 WebSocket 连接..."}),t.initWebsocket()}),5e3)},_send:function(t){this.ws.send(JSON.stringify(t))},onSubmit:function(t,e){var r=this;return Object(I["a"])(regeneratorRuntime.mark((function t(){var a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.preventDefault(),a=r.$refs.paramForm.form,t.prev=2,t.next=5,J(r.$route.params.id,a);case 5:return t.next=7,r.getStrategySpecView();case 7:r.$bvModal.hide("param-form-modal"),t.next=13;break;case 10:t.prev=10,t.t0=t["catch"](2),t.t0.response?500===t.t0.response.status?r.$bvToast.toast("服务端错误: ".concat(t.t0.response.status),{title:"更新失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):400===t.t0.response.status||r.$bvToast.toast(t.t0.message,{title:"数据获取失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):r.$bvToast.toast(t.t0.message,{title:"数据获取失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1});case 13:case"end":return t.stop()}}),t,null,[[2,10]])})))()},getRobot:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,dt(t.$route.params.id);case 3:r=e.sent,a=r.data,t.robotId=a.id,t.positionStore=a["position_store"],t.orderStore=a["order_store"],t.overviewData={name:a.name,pair:a.pair,marketType:a["market_type"],RobotId:t.robotId,strategyName:a["strategy_name"],targetCurrency:a["target_currency"],baseCurrency:a["base_currency"],quoteCurrency:a["quote_currency"],durationDisplay:a["duration_display"],marketTypeDisplay:a["market_type_display"],exchangeName:a.exchange.name,testNet:a["test_net"],enabled:a.enabled,totalPrincipal:a["asset_record"]["total_principal"],totalBalance:a["asset_record"]["total_balance"],totalPnlAbs:a["asset_record"]["total_pnl_abs"],totalPnlAbs24h:a["asset_record"]["total_pnl_abs_24h"],totalPnlRelPtg:a["asset_record"]["total_pnl_rel_ptg"],totalPnlRelPtg24h:a["asset_record"]["total_pnl_rel_ptg_24h"]},e.next=14;break;case 11:e.prev=11,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("获取机器人数据失败",{title:"获取机器人数据失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"获取机器人数据失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 14:case"end":return e.stop()}}),e,null,[[0,11]])})))()},getStrategySpecView:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,G(t.$route.params.id);case 3:r=e.sent,t.strategySpecView=r.data,e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("策略视图获取失败",{title:"策略视图获取失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"策略视图获取失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}}},er=tr,rr=Object(m["a"])(er,Zt,Gt,!1,null,"19ad70a8",null),ar=rr.exports,nr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"fixed-top fixed-bottom login-page"},[r("b-row",[r("b-col",{attrs:{sm:"12",md:"6",lg:"4","offset-md":"3","offset-lg":"4"}},[r("b-card",{staticClass:"p-lg-3"},[r("div",{staticClass:"title py-4 text-secondary"},[r("b-icon",{staticClass:"mr-4",attrs:{icon:"x-diamond",scale:"3"}}),r("h4",[t._v("渔夫量化")])],1),r("div",{staticClass:"text-center small text-secondary py-4 mb-2"},[t._v("使用账号密码登录")]),r("b-form",{on:{submit:t.onSubmit}},[r("b-alert",{attrs:{show:t.errors&&Object.keys(t.errors).length>0,variant:"danger"}},[t._v(" "+t._s(t.errors["non_field_errors"]&&t.errors["non_field_errors"][0])+" ")]),r("b-form-group",[r("b-input-group",{staticClass:"input-group",attrs:{size:"lg"}},[r("b-input-group-prepend",{staticClass:"prepend-class"},[r("b-icon",{attrs:{icon:"person-fill"}})],1),r("b-form-input",{staticClass:"input-class",attrs:{type:"text",placeholder:"",required:""},model:{value:t.form.username,callback:function(e){t.$set(t.form,"username",e)},expression:"form.username"}})],1)],1),r("b-form-group",[r("b-input-group",{staticClass:"input-group",attrs:{size:"lg"}},[r("b-input-group-prepend",{staticClass:"prepend-class"},[r("b-icon",{attrs:{icon:"key-fill"}})],1),r("b-input",{staticClass:"input-class",attrs:{placeholder:"密码",type:"password",required:""},model:{value:t.form.password,callback:function(e){t.$set(t.form,"password",e)},expression:"form.password"}})],1)],1),r("b-button",{staticClass:"mt-5 mb-4",attrs:{size:"lg",type:"submit",block:"",variant:"primary",disabled:t.formProcessing}},[t._v("登录")])],1)],1)],1)],1)],1)},sr=[];function or(t){return ir.apply(this,arguments)}function ir(){return ir=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",K.post("/auth/login/",e));case 1:case"end":return t.stop()}}),t)}))),ir.apply(this,arguments)}var cr={data:function(){return{form:{username:"",password:""},errors:{},formProcessing:!1}},methods:{login:function(t,e){var r={username:t,password:e};return or(r)},onSubmit:function(t){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){var a,n,s,o,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return e.formProcessing=!0,t.preventDefault(),r.prev=2,r.next=5,e.login(e.form.username,e.form.password);case 5:return a=r.sent,n=a.data,s=n["auth_token"],e.$store.commit("SET_AUTH_TOKEN",s),U.saveAuthToken(s),o=n.user,i={userId:o.id,username:o.username,nickname:o.nickname},e.$store.commit("SET_USER",i),U.saveUser(i),e.formProcessing=!1,r.next=17,e.$router.push({name:"robot-list"});case 17:r.next=26;break;case 19:r.prev=19,r.t0=r["catch"](2),r.t0.response?r.t0.response.status>=500?e.$bvToast.toast("服务端错误",{title:"登录失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):r.t0.response.status>=400&&(e.errors=r.t0.response.data):e.$bvToast.toast(r.t0.message,{title:"登录失败",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}),e.$store.commit("REMOVE_AUTH_TOKEN"),e.$store.commit("REMOVE_USER"),U.clear(),e.formProcessing=!1;case 26:case"end":return r.stop()}}),r,null,[[2,19]])})))()}}},lr=cr,ur=(r("6a77"),Object(m["a"])(lr,nr,sr,!1,null,"58471245",null)),dr=ur.exports,mr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-3"},[r("b-card",{attrs:{"header-tag":"header"},scopedSlots:t._u([{key:"header",fn:function(){return[r("h6",{staticClass:"mb-0"},[t._v("绑定交易所凭据")])]},proxy:!0}])},[r("b-card-text",[r("b-row",{},[r("b-col",{attrs:{sm:"12",md:"9"}},[r("credential-form",{attrs:{"exchange-options":t.exchangeOptions,"form-initial":t.credentialFormInitial},on:{submitted:t.getCredentialList}})],1),r("b-col",{attrs:{sm:"12",md:"3"}},[r("credential-helper")],1)],1)],1)],1),r("b-row",{staticClass:"mt-4"},t._l(t.credentialList,(function(e){return r("b-col",{key:e.credId,staticClass:"mb-3",attrs:{sm:"12",md:"6",lg:"4"}},[r("credential-item",{attrs:{credential:e},on:{"delete-confirmed":t.deleteCredential,edit:t.setCredentialFormInitial}})],1)})),1)],1)},pr=[],fr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-form",{staticClass:"form-row",on:{submit:t.onSubmit}},[r("b-col",{attrs:{md:"4"}},[r("b-form-group",{attrs:{label:"交易所:","label-for":"id_exchange"}},[r("b-form-select",{attrs:{id:"id_exchange",options:t.exchangeOptions,required:"",disabled:t.disableExchange,state:void 0===t.formErrors.exchange&&null},model:{value:t.form.exchange,callback:function(e){t.$set(t.form,"exchange",e)},expression:"form.exchange"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.exchange&&null}},[t._v(" "+t._s(void 0!==t.formErrors.exchange&&t.formErrors.exchange[0])+" ")])],1)],1),r("b-col",{attrs:{md:"4"}},[r("b-form-group",{attrs:{label:"备注:","label-for":"id_note"}},[r("b-form-input",{attrs:{id:"id_note",type:"text",required:"",state:void 0===t.formErrors.note&&null},model:{value:t.form.note,callback:function(e){t.$set(t.form,"note",e)},expression:"form.note"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.note&&null}},[t._v(" "+t._s(void 0!==t.formErrors.note&&t.formErrors.note[0])+" ")])],1)],1),r("b-col",{attrs:{md:"4"}},[r("b-form-group",{attrs:{label:"API Key:","label-for":"id_api_key"}},[r("b-form-input",{attrs:{id:"id_api_key",required:"",autocomplete:"new-password",state:void 0===t.formErrors["api_key"]&&null},model:{value:t.form.apiKey,callback:function(e){t.$set(t.form,"apiKey",e)},expression:"form.apiKey"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors["api_key"]&&null}},[t._v(" "+t._s(void 0!==t.formErrors["api_key"]&&t.formErrors["api_key"][0])+" ")])],1)],1),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Secret:","label-for":"id_secret"}},[r("b-form-input",{attrs:{id:"id_secret",type:"password",required:"",autocomplete:"new-password"},model:{value:t.form.secret,callback:function(e){t.$set(t.form,"secret",e)},expression:"form.secret"}})],1)],1),r("b-col",{attrs:{md:"6"}},[r("b-form-group",{attrs:{label:"Passphrase:","label-for":"id_passphrase"}},[r("b-form-input",{attrs:{id:"id_passphrase",type:"password",autocomplete:"new-password"},model:{value:t.form.passphrase,callback:function(e){t.$set(t.form,"passphrase",e)},expression:"form.passphrase"}})],1)],1),r("b-col",{attrs:{md:"12"}},[r("b-form-checkbox",{attrs:{id:"id_test_net",name:"test_net",value:"true","unchecked-value":"false"},model:{value:t.form.testNet,callback:function(e){t.$set(t.form,"testNet",e)},expression:"form.testNet"}},[t._v(" 测试网 ")])],1),r("b-col",{staticClass:"text-center mt-3"},[r("b-button",{staticClass:"mr-3",attrs:{type:"submit",variant:"primary"}},[t._v(t._s(t.editing?"更新":"绑定"))]),r("b-button",{attrs:{type:"button",variant:"danger"},on:{click:t.reset}},[t._v("清空")])],1)],1)},br=[];function vr(){return gr.apply(this,arguments)}function gr(){return gr=Object(I["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,M.get("/credentials/");case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),gr.apply(this,arguments)}function hr(t){return _r.apply(this,arguments)}function _r(){return _r=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.post("/credentials/",e));case 1:case"end":return t.stop()}}),t)}))),_r.apply(this,arguments)}function yr(t){return xr.apply(this,arguments)}function xr(){return xr=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.delete("/credentials/"+e+"/"));case 1:case"end":return t.stop()}}),t)}))),xr.apply(this,arguments)}function wr(t,e){return kr.apply(this,arguments)}function kr(){return kr=Object(I["a"])(regeneratorRuntime.mark((function t(e,r){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.patch("/credentials/"+e+"/",r));case 1:case"end":return t.stop()}}),t)}))),kr.apply(this,arguments)}var jr={name:"CredentialForm",props:{formInitial:{type:Object,default:null},exchangeOptions:{type:Array,default:function(){return[]}}},data:function(){return{form:{credentialId:null,note:"",apiKey:"",secret:"",passphrase:"",exchange:null,testNet:!1},formErrors:{},disableExchange:!1,editing:!1}},watch:{formInitial:function(t){null!==t&&(this.reset(),this.form=Object.assign({},this.form,this.formInitial),this.disableExchange=!0,this.editing=!0)}},methods:{reset:function(){this.form={credentialId:null,note:"",apiKey:"",secret:"",passphrase:"",exchange:null,testNet:!1},this.editing=!1,this.disableExchange=!1,this.formErrors={}},onSubmit:function(t){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(t.preventDefault(),null!==e.form.credentialId){r.next=6;break}return r.next=4,e.create();case 4:r.next=8;break;case 6:return r.next=8,e.update();case 8:case"end":return r.stop()}}),r)})))()},create:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={note:t.form.note,api_key:t.form.apiKey,secret:t.form.secret,passphrase:t.form.passphrase,exchange:t.form.exchange,test_net:t.form.testNet},e.prev=1,e.next=4,hr(r);case 4:t.$bvToast.toast("交易所凭据绑定成功",{title:"交易所凭据绑定成功",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"success",appendToast:!1}),t.reset(),t.$emit("submitted"),e.next=19;break;case 9:if(e.prev=9,e.t0=e["catch"](1),!e.t0.response){e.next=18;break}if(400!==e.t0.response.status){e.next=15;break}return t.formErrors=e.t0.response.data,e.abrupt("return");case 15:t.$bvToast.toast("交易所凭据绑定失败",{title:"交易所凭据绑定失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}),e.next=19;break;case 18:t.$bvToast.toast(e.t0.message,{title:"交易所凭据绑定失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 19:case"end":return e.stop()}}),e,null,[[1,9]])})))()},update:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r={note:t.form.note,api_key:t.form.apiKey,secret:t.form.secret,passphrase:t.form.passphrase,exchange:t.form.exchange,test_net:t.form.testNet},e.prev=1,e.next=4,wr(t.form.credentialId,r);case 4:t.$bvToast.toast("交易所凭据更新成功",{title:"交易所凭据更新成功",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"success",appendToast:!1}),t.editing=!1,t.disableExchange=!1,t.reset(),t.$emit("submitted"),e.next=21;break;case 11:if(e.prev=11,e.t0=e["catch"](1),!e.t0.response){e.next=20;break}if(400!==e.t0.response.status){e.next=17;break}return t.formErrors=e.t0.response.data,e.abrupt("return");case 17:t.$bvToast.toast("交易所凭据更新失败",{title:"交易所凭据更新失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}),e.next=21;break;case 20:t.$bvToast.toast(e.t0.message,{title:"交易所凭据更新失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 21:case"end":return e.stop()}}),e,null,[[1,11]])})))()}}},Cr=jr,Tr=Object(m["a"])(Cr,fr,br,!1,null,null,null),Or=Tr.exports,Er=function(){var t=this,e=t.$createElement;t._self._c;return t._m(0)},$r=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("a",{attrs:{href:"https://yufuquant.github.io/yufuquant-user-manual/credential/",target:"_blank"}},[t._v("帮助文档")])])}],Rr={name:"CredentialHelper"},Sr=Rr,Ir=Object(m["a"])(Sr,Er,$r,!1,null,null,null),Dr=Ir.exports,Pr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",[r("div",{staticClass:"justify-content-between d-flex mb-2"},[r("span",{staticClass:"font-weight-bold"},[t._v(t._s(t.credential.note))]),r("span",{staticClass:"action-buttons"},[r("a",{staticClass:"mr-2",attrs:{href:"#"},on:{click:t.edit}},[r("b-icon-pencil-square")],1),r("a",{staticClass:"text-danger",attrs:{href:"#"},on:{click:function(e){return t.showPrompt(t.credential.credId)}}},[r("b-icon-trash")],1)])]),r("div",{staticClass:"credential"},[r("b-icon",{staticClass:"mr-2",attrs:{icon:"lock",variant:"success"}}),r("span",{staticClass:"text-success"},[t._v("API Key：")]),r("span",{staticClass:"text-muted"},[t._v(t._s(t.credential.apiKey))])],1),r("div",{staticClass:"credential"},[r("b-icon",{staticClass:"mr-2",attrs:{icon:"lock",variant:"success"}}),r("span",{staticClass:"text-success"},[t._v("Secret：")]),r("span",{staticClass:"text-muted"},[t._v(t._s(t.credential.secret))])],1),r("div",{staticClass:"credential"},[r("b-icon",{staticClass:"mr-2",attrs:{icon:"lock",variant:"success"}}),r("span",{staticClass:"text-success"},[t._v("Passphrase：")]),r("span",{staticClass:"text-muted"},[t._v(t._s(t.credential.passphrase||"-"))])],1)])},Lr=[],Hr={name:"CredentialItem",props:{credential:Object},methods:{edit:function(){var t={credentialId:this.credential.credId,exchange:this.credential.exchangeId,note:this.credential.note,testNet:this.credential.testNet};this.$emit("edit",{initial:t})},showPrompt:function(t){var e=this;this.$bvModal.msgBoxConfirm("删除交易所凭据将连带删除关联的机器人，这可能导致交易异常。",{title:"确认删除？",size:"sm",buttonSize:"sm",okVariant:"danger",okTitle:"确认",cancelTitle:"取消",footerClass:"p-2",hideHeaderClose:!1,centered:!0}).then((function(r){r&&e.$emit("delete-confirmed",{credId:t})})).catch((function(t){console.log(t)}))}}},zr=Hr,Ur=(r("9327"),Object(m["a"])(zr,Pr,Lr,!1,null,"0ffba64a",null)),qr=Ur.exports,Nr={name:"CredentialView",data:function(){return{credentialList:[],exchangeOptions:[],credentialFormInitial:null}},components:{CredentialForm:Or,CredentialItem:qr,CredentialHelper:Dr},methods:{getExchangeList:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,at();case 3:r=e.sent,t.exchangeOptions=r.data.map((function(t){return{value:t.id,text:t["name_zh"]}})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("获取可接入交易所列表失败",{title:"获取可接入交易所列表失败",autoHideDelay:3e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"获取可接入交易所列表失败",autoHideDelay:3e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},getCredentialList:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,vr();case 3:r=e.sent,t.credentialList=r.data.map((function(t){return{credId:t.id,exchangeNameZh:t.exchange["name_zh"],exchangeId:t.exchange.id,note:t.note,apiKey:t["api_key"],secret:t.secret,passphrase:t.passphrase,testNet:t["test_net"],createdAt:t["created_at"]}})),e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("获取已绑定交易所凭据列表失败",{title:"获取已绑定交易所凭据列表失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"获取已绑定交易所凭据列表失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()},deleteCredential:function(t){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=t.credId,r.prev=1,r.next=4,yr(a);case 4:return r.next=6,e.getCredentialList();case 6:r.next=11;break;case 8:r.prev=8,r.t0=r["catch"](1),r.t0.response?e.$bvToast.toast("交易所凭据删除失败",{title:"交易所凭据删除失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}):e.$bvToast.toast(r.t0.message,{title:"交易所凭据删除失败",autoHideDelay:3e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 11:case"end":return r.stop()}}),r,null,[[1,8]])})))()},handleCredentialFormSubmit:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCredentialList();case 2:case"end":return e.stop()}}),e)})))()},setCredentialFormInitial:function(t){var e=t.initial;this.credentialFormInitial=e}},mounted:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,t.getCredentialList();case 2:return e.next=4,t.getExchangeList();case 4:case"end":return e.stop()}}),e)})))()}},Br=Nr,Ar=Object(m["a"])(Br,mr,pr,!1,null,null,null),Fr=Ar.exports,Vr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("div",[t._v("UID: "+t._s(t.userId))]),r("div",[t._v("用户名: "+t._s(t.username))]),t.hideToken?r("div",{},[r("span",{staticClass:"mr-2"},[t._v("认证令牌: "+t._s(t.maskedToken))]),r("b-icon-eye",{on:{click:function(e){t.hideToken=!t.hideToken}}})],1):t._e(),t.hideToken?t._e():r("div",{},[r("span",{staticClass:"mr-2"},[t._v("认证令牌: "+t._s(t.token))]),r("b-icon-eye-slash",{on:{click:function(e){t.hideToken=!t.hideToken}}})],1)])},Kr=[],Mr=(r("38cf"),{data:function(){return{hideToken:!0}},computed:Object(N["a"])(Object(N["a"])({},Object(q["b"])({userId:function(t){return t.user.userId},username:function(t){return t.user.username},nickname:function(t){return t.user.nickname},token:function(t){return t.user.token}})),{},{maskedToken:function(){return"*".repeat(this.token.length)}})}),Jr=Mr,Wr=Object(m["a"])(Jr,Vr,Kr,!1,null,null,null),Yr=Wr.exports,Zr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-sm-2 mx-md-3"},[r("div",{staticClass:"mb-3"},[r("router-link",{attrs:{to:{name:"strategy-add"}}},[r("b-button",{attrs:{variant:"primary"}},[r("b-icon",{attrs:{icon:"plus","aria-hidden":"true"}}),t._v(" 新增策略 ")],1)],1)],1),r("b-row",t._l(t.strategyList,(function(t){return r("b-col",{key:t.id,staticClass:"mb-3",attrs:{sm:"12",md:"6",lg:"4"}},[r("strategy-item",{staticClass:"strategy-item",attrs:{strategy:t}})],1)})),1)],1)},Gr=[],Qr=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-card",[r("div",[r("b-media",{attrs:{"no-body":""}},[r("b-media-aside",{attrs:{"vertical-align":"center"}},[r("b-icon-graph-up",{staticClass:"text-muted",attrs:{"font-scale":"1.5"}})],1),r("b-media-body",{staticClass:"ml-3"},[r("h5",[r("router-link",{attrs:{to:{name:"strategy-detail",params:{id:t.strategy.id}}}},[t._v(" "+t._s(t.strategy.name)+" ")])],1),r("div",{staticClass:"small text-muted"},[t._v(t._s(t.strategy.brief))])])],1)],1)])},Xr=[],ta={name:"StrategyItem",props:{strategy:Object}},ea=ta,ra=Object(m["a"])(ea,Qr,Xr,!1,null,"775c3310",null),aa=ra.exports,na={name:"strategy-list",components:{StrategyItem:aa},data:function(){return{strategyList:[]}},methods:{setStrategyList:function(t){this.strategyList=t.map((function(t){return{id:t.id,name:t.name,brief:t.brief,description:t.description}}))},getStrategyList:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,bt();case 3:r=e.sent,console.log(r),t.setStrategyList(r.data.results),e.next=11;break;case 8:e.prev=8,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("无法获取策略列表数据",{title:"无法获取策略列表数据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"无法获取策略列表数据",autoHideDelay:3e3,toaster:"b-toaster-top-center",variant:"danger",appendToast:!1});case 11:case"end":return e.stop()}}),e,null,[[0,8]])})))()}},mounted:function(){this.getStrategyList()}},sa=na,oa=(r("dda1"),Object(m["a"])(sa,Zr,Gr,!1,null,"a0f9ddba",null)),ia=oa.exports,ca=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-sm-2 mx-md-3"},[r("b-row",[r("b-col",{attrs:{md:"8"}},[r("b-card",{attrs:{header:"新增策略","header-tag":"header"}},[r("strategy-form")],1)],1)],1)],1)},la=[],ua=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("b-form",{on:{submit:t.onSubmit}},[r("b-form-group",{attrs:{label:"名称：","label-for":"id_name"}},[r("b-form-input",{attrs:{id:"id_name",type:"text",required:"",state:void 0===t.formErrors.name&&null},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.name&&null}},[t._v(" "+t._s(void 0!==t.formErrors.name&&t.formErrors.name[0])+" ")])],1),r("b-form-group",{attrs:{label:"简介：","label-for":"id_brief"}},[r("b-form-input",{attrs:{id:"id_brief",type:"text",state:void 0===t.formErrors.brief&&null},model:{value:t.form.brief,callback:function(e){t.$set(t.form,"brief",e)},expression:"form.brief"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.brief&&null}},[t._v(" "+t._s(void 0!==t.formErrors.brief&&t.formErrors.brief[0])+" ")])],1),r("b-form-group",{attrs:{label:"详细描述：","label-for":"id_description"}},[r("b-form-textarea",{attrs:{id:"id_description",rows:"3","max-rows":"6",state:void 0===t.formErrors.description&&null},model:{value:t.form.description,callback:function(e){t.$set(t.form,"description",e)},expression:"form.description"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.description&&null}},[t._v(" "+t._s(void 0!==t.formErrors.description&&t.formErrors.description[0])+" ")])],1),r("b-form-group",{attrs:{label:"规范：","label-for":"id_specification"}},[r("b-tabs",{attrs:{"content-class":"mt-3",small:""}},[r("b-tab",{attrs:{title:"文本模式",active:""},on:{click:function(e){t.specInputMode="text"}}},[r("b-form-textarea",{attrs:{id:"textarea",placeholder:"",rows:"3","max-rows":"6",state:void 0===t.formErrors.specification&&null},model:{value:t.form.specificationText,callback:function(e){t.$set(t.form,"specificationText",e)},expression:"form.specificationText"}}),r("b-form-invalid-feedback",{attrs:{state:void 0===t.formErrors.specification&&null}},[t._v(" "+t._s(void 0!==t.formErrors.specification&&t.formErrors.specification[0])+" ")])],1),r("b-tab",{attrs:{title:"编辑模式"},on:{click:function(e){t.specInputMode="ui"}}},[r("JsonEditor",{attrs:{options:{confirmText:"确认",cancelText:"取消"},objData:t.form.specificationUI},model:{value:t.form.specificationUI,callback:function(e){t.$set(t.form,"specificationUI",e)},expression:"form.specificationUI"}})],1)],1)],1),r("b-button",{staticClass:"mt-2",attrs:{type:"submit",variant:"primary"}},[t._v("提交")])],1)},da=[];function ma(t){return pa.apply(this,arguments)}function pa(){return pa=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.get("/strategies/"+e+"/"));case 1:case"end":return t.stop()}}),t)}))),pa.apply(this,arguments)}function fa(t){return ba.apply(this,arguments)}function ba(){return ba=Object(I["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",M.post("/strategies/",e));case 1:case"end":return t.stop()}}),t)}))),ba.apply(this,arguments)}var va={name:"StrategyForm",data:function(){return{specInputMode:"text",form:{name:"",brief:"",description:"",specificationUI:{},specificationText:""},submitting:!1,formErrors:{}}},methods:{onSubmit:function(t){var e=this;return Object(I["a"])(regeneratorRuntime.mark((function r(){var a;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return t.preventDefault(),e.submitting=!0,a={name:e.form.name,brief:e.form.brief,description:e.form.description,specification:"ui"===e.specInputMode?JSON.stringify(e.form.specificationUI):e.form.specificationText},r.prev=3,r.next=6,fa(a);case 6:return r.next=8,e.$router.push({name:"strategy-list"});case 8:e.submitting=!1,r.next=14;break;case 11:r.prev=11,r.t0=r["catch"](3),r.t0.response?500===r.t0.response.status?e.$bvToast.toast("服务端错误",{title:"新增策略失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}):400===r.t0.response.status&&(e.formErrors=r.t0.response.data):e.$bvToast.toast(r.t0.message,{title:"新增策略失败",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 14:case"end":return r.stop()}}),r,null,[[3,11]])})))()}}},ga=va,ha=Object(m["a"])(ga,ua,da,!1,null,"4951cbdb",null),_a=ha.exports,ya={name:"StrategyAddView",components:{StrategyForm:_a},data:function(){return{}},methods:{},mounted:function(){}},xa=ya,wa=Object(m["a"])(xa,ca,la,!1,null,"39f57c65",null),ka=wa.exports,ja=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{staticClass:"mx-sm-2 mx-md-3"},[r("b-row",[r("b-col",{attrs:{md:"8"}},[r("h3",[t._v(t._s(t.strategy.name))]),r("div",{staticClass:"mt-2 text-muted small"},[t._v(t._s(t.strategy.brief))]),r("div",{staticClass:"mt-3"},[t._v(t._s(t.strategy.description))])])],1)],1)},Ca=[],Ta={name:"StrategyDetailView",data:function(){return{strategy:{}}},methods:{getStrategyDetail:function(){var t=this;return Object(I["a"])(regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,ma(t.$route.params.id);case 3:r=e.sent,t.strategy={name:r.data.name,brief:r.data.brief,description:r.data.description},e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](0),e.t0.response?t.$bvToast.toast("无法获取策略详情",{title:"无法获取策略详情",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1}):t.$bvToast.toast(e.t0.message,{title:"无法获取策略详情",autoHideDelay:2e3,toaster:"b-toaster-top-right",variant:"danger",appendToast:!1});case 10:case"end":return e.stop()}}),e,null,[[0,7]])})))()}},mounted:function(){this.getStrategyDetail()}},Oa=Ta,Ea=Object(m["a"])(Oa,ja,Ca,!1,null,"4ce88930",null),$a=Ea.exports;a["default"].use($["a"]);var Ra=[{path:"/",component:Pt},{path:"/robot/list",name:"robot-list",component:Pt},{path:"/robot/create",name:"robot-create",component:yt},{path:"/robot/:id",name:"robot",component:ar},{path:"/robot/:id/update",name:"robot-update",component:Yt},{path:"/login",component:dr},{path:"/credential",name:"credential",component:Fr},{path:"/account",component:Yr},{path:"/strategy/list",name:"strategy-list",component:ia},{path:"/strategy/add",name:"strategy-add",component:ka},{path:"/strategy/:id",name:"strategy-detail",component:$a}],Sa=new $["a"]({routes:Ra}),Ia=Sa;a["default"].use(E.a),a["default"].use(T.a),a["default"].config.productionTip=!1,new a["default"]({render:function(t){return t(j)},router:Ia,store:V}).$mount("#app")},"5ae7":function(t,e,r){},"5c0b":function(t,e,r){"use strict";r("9c0c")},"63de":function(t,e,r){},"64ef":function(t,e,r){},"6a77":function(t,e,r){"use strict";r("2c0e")},"847e":function(t,e,r){"use strict";r("a392")},9327:function(t,e,r){"use strict";r("63de")},"9c0c":function(t,e,r){},"9f80":function(t,e,r){"use strict";r("21ba")},a050:function(t,e,r){"use strict";r("4ddf")},a0a6:function(t,e,r){},a392:function(t,e,r){},a736:function(t,e,r){"use strict";r("a0a6")},dda1:function(t,e,r){"use strict";r("efa8")},de3f:function(t,e,r){"use strict";r("5ae7")},efa8:function(t,e,r){}});
//# sourceMappingURL=app.a78626d7.js.map